<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>plang: Builtin predicates - Classes and objects</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Builtin predicates - Classes and objects</h1><table border="0" cellpadding="0" cellspacing="0">
</table>
<p>Predicates in this group are used to create classes and objects, and to manipulate them after creation.</p>
<p><a class="el" href="group__classes__and__objects.html#decl_class">class</a>, <a class="el" href="group__classes__and__objects.html#new_object_3">new</a>, <a class="el" href="group__classes__and__objects.html#new_class_4">new_class/4</a>, <a class="el" href="group__classes__and__objects.html#new_object_3">new_object/3</a></p>
<hr/>
 <a class="anchor" id="decl_class"></a> <a class="anchor" id="new_class_4"></a> <b>class</b>, <b>new_class/4</b> - declares a new class.</p>
<dl class="user"><dt><b>Usage</b></dt><dd><b>class</b> <em>Name</em> { <em>Members</em> } </dd></dl>
<dl class="user"><dt><b></b></dt><dd><b>class</b> <em>Name</em> : <em>Parent</em> { <em>Members</em> } </dd></dl>
<dl class="user"><dt><b></b></dt><dd><b>new_class</b>(<em>Name</em>, <em>Parent</em>, <em>Vars</em>, <em>Clauses</em>)</dd></dl>
<dl class="user"><dt><b>Description</b></dt><dd>The <em>Name</em> must be an atom to identify the new class that is different than all previous atoms used as class names. If <em>Parent</em> is present, then it must be an atom that identifies an existing class, or <code>[]</code> for no parent. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Usually classes are created in the source file with the <b>class</b> keyword. The <b>new_class/4</b> predicate can be used to create a class dynamically. </dd></dl>
<dl class="user"><dt><b></b></dt><dd><em>Vars</em> must be a list of atoms for the member field names. These members will be added as unbound variable properties to new objects of the class <em>Name</em>. Duplicates in <em>Vars</em> will be ignored. </dd></dl>
<dl class="user"><dt><b></b></dt><dd><em>Clauses</em> must be a list of <b>clause</b>(<em>MemberName</em>, <em>Kind</em>, <em>Clause</em>) terms: <ul>
<li><em>MemberName</em> is the name of the predicate member, without the class <em>Name</em> as a qualifier. </li>
<li><em>Kind</em> is one of the atoms <code>member</code>, <code>static</code>, or <code>constructor</code>, indicating an ordinary member predicate, a static predicate, or an object constructor. </li>
<li><em>Clause</em> is a <b>(:-)/2</b> functor term for a single clause within the predicate being defined. The clause should have the predicate name <em>Name:</em>:<em>MemberName</em>. If the <em>Kind</em> is <code>member</code> or <code>constructor</code>, then the first argument of <em>Clause</em> will be passed the <code>Self</code> object when the predicate is called. </li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd>The atoms <code>className</code> and <code>prototype</code> are reserved and cannot be used as member names for declared variable or predicate members. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Class <em>Members</em> may have one of the following forms, corresponding to member variables, regular member predicates, static predicates, and constructor predicates: <div class="fragment"><pre class="fragment"> var name1, ..., nameN
 name(Args) { ... }
 <span class="keyword">static</span> name(Args) { ... }
 <span class="keyword">new</span>(Args) { ... }
</pre></div> </dd></dl>
<dl class="user"><dt><b></b></dt><dd>When an object is constructed with the <a class="el" href="group__classes__and__objects.html#new_object_3">new</a> keyword, it is initially populated with <code>name1</code>, ..., <code>nameN</code> set to unbound variables, and <code>prototype</code> set to the class object. One of the constructor predicates is then called to initialize the object. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Regular member predicates and constructor predicates are passed the <code>Self</code> object as a hidden first argument. Static predicates do not have any hidden arguments.</dd></dl>
<dl class="user"><dt><b>Errors</b></dt><dd></dd></dl>
<ul>
<li><code>instantiation_error</code> - <em>Name</em>, <em>Parent</em>, <em>Vars</em>, or <em>Clauses</em> is a variable. </li>
<li><code>type_error(atom, <em>Name</em>)</code> - <em>Name</em> is not an atom. </li>
<li><code>type_error(atom, <em>Parent</em>)</code> - <em>Parent</em> is not an atom. </li>
<li><code>type_error(atom, <em>Var</em>)</code> - <em>Var</em> is a member of <em>Vars</em> but it is not an atom. </li>
<li><code>type_error(atom_list, <em>Vars</em>)</code> - <em>Vars</em> is not a valid list of atoms. </li>
<li><code>type_error(clause_list, <em>Clauses</em>)</code> - <em>Clauses</em> is not a valid list of clauses. </li>
<li><code>type_error(member_name, <em>MemberName</em>)</code> - <em>MemberName</em> is <code>className</code> or <code>prototype</code>. </li>
<li><code>permission_error(create, class, <em>Name</em>)</code> - <em>Name</em> already exists as a class. </li>
<li><code>permission_error(modify, static_procedure, <em>Pred</em>)</code> - attempting to define a predicate <em>Pred</em> that is already defined. </li>
<li><code>existence_error(class, <em>Parent</em>)</code> - <em>Parent</em> does not exist as a class, and <em>Parent</em> is not <code>[]</code>.</li>
</ul>
<dl class="user"><dt><b>Examples</b></dt><dd><div class="fragment"><pre class="fragment"> <span class="keyword">class </span>vehicle
 {
     var owner, wheels
     transferOwnership(NewOwner)
     {
         Self.owner := NewOwner;
     }
 }

 <span class="keyword">class </span>passenger_car : vehicle
 {
     var make, model
     <span class="keyword">new</span>(Make, Model)
     {
         Self.wheels = 4;
         Self.make = Make;
         Self.model = Model;
     }
 }

 <span class="keyword">class </span>company
 {
     var name
     var fleet
     <span class="keyword">new</span>(Name)
     {
         Self.name = Name;
         Self.fleet = [];
     }
     add_vehicle(Vehicle)
     {
         Self.fleet := [Vehicle|Self.fleet];
     }
     remove_vehicle(Vehicle)
     {
         <span class="keyword">remove</span>(Vehicle, Self.fleet, List);
         Self.fleet := List;
     }
 }

 <span class="keyword">class </span>truck : vehicle
 {
     var company
     <span class="keyword">new</span>(Company, Wheels)
     {
         Self.company = Company;
         Self.owner = Company.name;
         Self.wheels = Wheels;
         Company.add_vehicle(Self);
     }
     transferOwnership(Company)
     {
         Self.company.remove_vehicle(Self);
         Self.company := Company;
         vehicle::transferOwnership(Self, Company.name);
         Company.add_vehicle(Self);
     }
 }

 <span class="keyword">class </span>semi_trailer : truck
 {
     <span class="keyword">new</span>(Company)
     {
         truck::new(Self, Company, 16);
     }
 }

 <span class="keyword">new</span> passenger_car(P, <span class="stringliteral">&quot;MegaCarz&quot;</span>, <span class="stringliteral">&quot;FastKar 2000&quot;</span>);
 P.owner = <span class="stringliteral">&quot;Fred&quot;</span>;
 P.transferOwnership(<span class="stringliteral">&quot;Mary&quot;</span>);

 <span class="keyword">new</span> company(C1, <span class="stringliteral">&quot;Package Delivery, Inc.&quot;</span>);
 <span class="keyword">new</span> company(C2, <span class="stringliteral">&quot;Deliver Packages, Inc.&quot;</span>);
 <span class="keyword">new</span> semi_trailer(S, C1);
 S.transferOwnership(C2);
</pre></div></dd></dl>
<dl class="user"><dt><b>See Also</b></dt><dd><a class="el" href="group__type__testing.html#class_1">class/1</a>, <a class="el" href="group__classes__and__objects.html#new_object_3">new</a></dd></dl>
<hr/>
 <a class="anchor" id="new_object_3"></a> <b>new</b>, <b>new_object/3</b> - create a new object instance of a class.</p>
<dl class="user"><dt><b>Usage</b></dt><dd><b>new</b> <em>Name</em>(<em>Var</em>, <em>Args</em>) </dd></dl>
<dl class="user"><dt><b></b></dt><dd><b>new_object</b>(<em>Name</em>, <em>Var</em>, <em>ArgList</em>)</dd></dl>
<dl class="user"><dt><b>Description</b></dt><dd>The <b>new</b> keyword constructs a new instance of the class <em>Name</em> and unifies it with <em>Var</em>. The comma-separated list of <em>Args</em> is passed to the constructor for <em>Name</em>. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <b>new_object/3</b> predicate performs the same operation for constructing objects dynamically. The <em>ArgList</em> is a regular Plang list rather than a comma-separated list.</dd></dl>
<dl class="user"><dt><b>Errors</b></dt><dd></dd></dl>
<ul>
<li><code>instantiation_error</code> - <em>Name</em> or <em>ArgList</em> is a variable, or the tail of <em>ArgList</em> is not <code>[]</code>. </li>
<li><code>type_error(atom, <em>Name</em>)</code> - <em>Name</em> is not an atom. </li>
<li><code>type_error(variable, <em>Var</em>)</code> - <em>Var</em> is not a variable. </li>
<li><code>type_error(list, <em>ArgList</em>)</code> - <em>ArgList</em> is not a list. </li>
<li><code>existence_error(class, <em>Name</em>)</code> - <em>Name</em> does not exist as a class. </li>
<li><code>existence_error(procedure, <em>Pred</em>)</code> - <em>Pred</em> is the name of the constructor predicate that <b>new</b> attempted to call but the constructor does not exist.</li>
</ul>
<dl class="user"><dt><b>Examples</b></dt><dd><div class="fragment"><pre class="fragment"> <span class="keyword">class </span>foo
 {
     <span class="keyword">new</span>(X, Y) { ... }
 }
 <span class="keyword">class </span>bar
 {
 }

 <span class="keyword">new</span> foo(F, 1.5, f(X))
 new bar(B)
 new_object(foo, F, [1.5, f(X)])
 new_object(bar, B, [])
</pre></div></dd></dl>
<dl class="user"><dt><b>See Also</b></dt><dd><a class="el" href="group__classes__and__objects.html#decl_class">class</a>, <a class="el" href="group__type__testing.html#object_1">object/1</a> </dd></dl>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 26 May 2011 for plang by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
